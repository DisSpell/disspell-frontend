<div> <h1>search/index.html.erb</h1></div>
<% unless @response == nil %>
  <div> <%= @response.count %> </div>
  <% @response.each do |x| %>

    <h1 style=>TITLE: <%= highlight(x._source.video_title, params[:query], highlighter: '<mark style="background-color:yellow";>\1</mark>') %></h1>
    <%= button_to 'Video Transcript', video_path(x._source.video_id), method: :get %>


    <% unless x._source.transcript == nil %>
      <% video_transcript_ts = multi_excerpt(x._source.transcript,  params[:query]) %>
      <% video_transcript_ts[0].each_with_index do |part, index| %>
        <p><%= video_transcript_ts[1][index] %></p>
        <p><%= highlight(part, params[:query]) %></p>
      <% end %>
    <% end %>
  <% end %>
<% end %>
        <br>

<br>
<br>
<%= form_with url: "/search", method: :get do |form| %>
  <%= form.label :query, "Search for:" %>
  <%= form.text_field :query %>
  <%= form.submit "Search" %>
<% end %>


<% if @result %>
  <% @result.each do |result| %>
    <% video = Video.find(result) %>
    <p> VIDEO ID: <%= video.id %></p>
    <h1>TITLE: <%= highlight(video.title, params[:query]) %></h1>
    <%= button_to 'Video Transcript', video_path(video), method: :get %>
    <p>PARAM: <%= params[:query] %></p>
    <% unless @transcript.find_by(video_id: video.id) == nil %>
      <% video_transcript_ts = multi_excerpt(@transcript.find_by(video_id: video.id).transcript, params[:query]) %>
      <% video_transcript_ts[0].each_with_index do |part, index| %>
        <br>
        <p><%= video_transcript_ts[1][index] %></p>
        <p><%= highlight(part, params[:query]) %></p>
        <br> 
      <% end %>
    <% end %>
  <% end %>
<% end %>
    
